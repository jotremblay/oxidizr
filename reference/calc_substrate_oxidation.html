<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate Substrate Oxidation — calc_substrate_oxidation • oxidizr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate Substrate Oxidation — calc_substrate_oxidation"><meta name="description" content="Calculate carbohydrate and fat oxidation rates from indirect calorimetry
using stoichiometric equations."><meta property="og:description" content="Calculate carbohydrate and fat oxidation rates from indirect calorimetry
using stoichiometric equations."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">oxidizr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/getting-started.html">Getting Started</a></li>
    <li><a class="dropdown-item" href="../articles/analysis-pipeline.html">Complete Analysis Pipeline</a></li>
    <li><a class="dropdown-item" href="../articles/data-quality.html">Data Validation &amp; Quality</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jotremblay/oxidizr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Calculate Substrate Oxidation</h1>
      <small class="dont-index">Source: <a href="https://github.com/jotremblay/oxidizr/blob/main/R/oxidation.R" class="external-link"><code>R/oxidation.R</code></a></small>
      <div class="d-none name"><code>calc_substrate_oxidation.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculate carbohydrate and fat oxidation rates from indirect calorimetry
using stoichiometric equations.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calc_substrate_oxidation</span><span class="op">(</span></span>
<span>  <span class="va">calo</span>,</span>
<span>  protein_ox <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  coefficients <span class="op">=</span> <span class="va">stoich_coefficients</span>,</span>
<span>  na_protein_action <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"zero"</span>, <span class="st">"error"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-calo">calo<a class="anchor" aria-label="anchor" href="#arg-calo"></a></dt>
<dd><p>A CalorimetryData object</p></dd>


<dt id="arg-protein-ox">protein_ox<a class="anchor" aria-label="anchor" href="#arg-protein-ox"></a></dt>
<dd><p>Optional protein oxidation data (from calc_protein_oxidation)</p></dd>


<dt id="arg-coefficients">coefficients<a class="anchor" aria-label="anchor" href="#arg-coefficients"></a></dt>
<dd><p>Stoichiometric coefficients (default: stoich_coefficients)</p></dd>


<dt id="arg-na-protein-action">na_protein_action<a class="anchor" aria-label="anchor" href="#arg-na-protein-action"></a></dt>
<dd><p>How to handle NA values in protein oxidation data.
One of:</p><ul><li><p><code>"mean"</code> (default): Replace NA with group mean, then 0 if all NA</p></li>
<li><p><code>"zero"</code>: Replace NA with 0 (assume negligible protein contribution)</p></li>
<li><p><code>"error"</code>: Raise an error if any NA values are present</p></li>
</ul></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A tibble with CHO and fat oxidation rates (g/min)</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Uses equations commonly attributed to Jequier et al. and Frayn,
with specific coefficients parameterized as presented in Telmosse (2022):</p>
<p>Non-protein calculations:</p><ul><li><p>VO2np = VO2 - (protein_ox * 1.0075)</p></li>
<li><p>VCO2np = VCO2 - (protein_ox * 0.8443)</p></li>
</ul><p>Substrate oxidation:</p><ul><li><p>CHO (g/min) = 4.618 * VCO2np - 3.279 * VO2np</p></li>
<li><p>Fat (g/min) = -1.712 * VCO2np + 1.712 * VO2np</p></li>
</ul><div class="section">
<h3 id="na-handling-strategies">NA Handling Strategies<a class="anchor" aria-label="anchor" href="#na-handling-strategies"></a></h3>


<p>When protein oxidation data contains NA values, the <code>na_protein_action</code>
parameter controls behavior:</p><ul><li><p><strong>"mean"</strong>: Imputes missing values with the mean of available protein
oxidation values. If all values are NA, uses 0. This preserves the
group average contribution but may not be appropriate for studies
with large inter-subject variability.</p></li>
<li><p><strong>"zero"</strong>: Treats missing protein oxidation as zero contribution.
Appropriate when protein contribution is expected to be negligible
(&lt; 5% of total energy) or when conservative estimates are preferred.</p></li>
<li><p><strong>"error"</strong>: Raises an error if any NA values are present. Recommended
for automated pipelines where missing data should halt processing.</p></li>
</ul></div>

    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Basic calculation (assuming negligible protein contribution)</span></span></span>
<span class="r-in"><span><span class="va">ox</span> <span class="op">&lt;-</span> <span class="fu">calc_substrate_oxidation</span><span class="op">(</span><span class="va">calo_data</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># With protein correction</span></span></span>
<span class="r-in"><span><span class="va">protein</span> <span class="op">&lt;-</span> <span class="fu"><a href="calc_protein_oxidation.html">calc_protein_oxidation</a></span><span class="op">(</span><span class="va">urea_loss</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ox</span> <span class="op">&lt;-</span> <span class="fu">calc_substrate_oxidation</span><span class="op">(</span><span class="va">calo_data</span>, protein_ox <span class="op">=</span> <span class="va">protein</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Strict mode for automated pipelines</span></span></span>
<span class="r-in"><span><span class="va">ox</span> <span class="op">&lt;-</span> <span class="fu">calc_substrate_oxidation</span><span class="op">(</span><span class="va">calo_data</span>, protein_ox <span class="op">=</span> <span class="va">protein</span>,</span></span>
<span class="r-in"><span>                               na_protein_action <span class="op">=</span> <span class="st">"error"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jonathan Tremblay.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

